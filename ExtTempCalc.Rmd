---
title: "Exterior Temperature Calculations"
output: html_notebook
bibliography: ExtTempCalc.bib # build this collection in Zotero and save in this directory
---

This notebook is documentation of a simple model of the heat transfer from the water in the tank to the test chamber under AS/NZS 4692.1. @joint_technical_committee_el-20___electric_water_heating_appliances_electric_2005
  
The heat transfer is conductive from the water through the insulation to the surface per Appendix E of AS/NZS 4692.1. Assume the surface temperature is constant and the same on all surfaces. Then from the top and side use a combination of radiative and convective heat transfer to ambient. The convective heat loss is both free and forced.c The heat transfer across the air gap is conductive down through air and radiative to the floor. Assume all surfaces in the test chamber are at the ambient temperatures.
  
Assume the water in the tank is perfectly mixed and at a constant temperature. Neglect the thermal resistance of the metal wall of the tank and at the surface of the insulation.

```{r}
Tamb   = 20  # °C
Twater = 75  # °C
Vair   = 0.25  # air speed within range of 0.25 m/s and 0.5 m/s
k      = 0.025  # polyurethane W/m-K, from 4234 Appendix E
```

The water heater and information about it are from the Predictive Modeling Tool (PMT)  @bart_milne_optimisation_2021 

This example is based on the Rinnai MS1805503 0 model tested to 4692. For volumes, dimensions, and insulation thicknesses see Table 7: Hot water cylinder model, MEPS and measurement information. 

```{r}
vol       =	0.18 # m^3	
diam      =	0.55 # m
height		= 1.295 # m
dx_side		= 0.053 # m side insulation thickness
dx_ends		= 0.060 # m top and bottom insulation thickness

```

Use heat transfer equations from Chapter 4, Heat Transfer, ASHRAE Fundamentals. @technical_committee_13_heat_transfer_and_fluid_flow_chapter_2017

## Conductive heat loss from water to surface #

The simple idealized tank model in 4234 Appendix E consists only of losses through the insulation on the sides and at the ends of the tank. There are no losses through the corners. Thus the insulation can be modeled as a hollow cylinder and to circular disks.

To check the equations at this stage assume the surface temperature of the insulation is 25 °C 

```{r}
Tsurf = 25 # °C 
```


### Conductive heat loss through side #

For the hollow cylinder the equation is written as,
$$Q_{side} = \frac{2 \pi k h}{ln(\frac{d_o}{d_i})} {\Delta T } $$
Or rewritten to account for the thicknesses of insulation,
$$Q_{side} = \frac{2 \pi k (height- 2 dx_{ends} )}
{ln(\frac{diam}{(diam-(2dx_{side}))})}{(T_{water} - T_{surf})) } $$


```{r}
Qside = ( 2 * pi * k * (height - 2 * dx_ends) ) / 
        ( log(diam/(diam-(2*dx_side)) ) ) *
          (Twater - Tsurf)

```
So with the assumed surface temperature, the heat loss through the side insulation is `r round(Qside,1)` (W) or in kWh/day `r round(Qside*(24/1000),3)`

### Conductive heat loss through ends #

The conductive loss from both ends is

$$
Q_{cond,ends} = \frac{2 \pi k ( (r_i)^2 (\Delta T) )}
{dx_{ends}}
$$
Which can be rewritten as 

$$
Q_{cond,ends} = \frac{2 \pi k  (\frac{diam- 2 dx_{ends}}{2})^2 (T_{water} - T_{surf}) }
{dx_{ends}}
$$
and then simplified as 

$$
Q_{cond,ends} = \frac{ \pi k  ({diam- 2 dx_{ends}})^2 (T_{water} - T_{surf}) }
{2dx_{ends}}
$$

```{r}
Qends = ( pi * k * (diam - 2 * dx_ends)^2  * (Twater - Tsurf) )/ 
        ( 2*dx_ends) 

```

So with the assumed surface temperature, the conductive heat loss through the insulation at the ends is `r round(Qends,1)` (W) or `r round(Qends*(24/1000),3)` (kWh/day)



### Conductive heat loss to surface #

So the total conductive losses to the surface are 

$$
Q_{surf} =  \frac{2 \pi k (height- 2 dx_{ends} )}
{ln(\frac{diam}{(diam-(2dx_{side}))})}{(T_{water} - T_{surf})) }
+ 
\frac{ \pi k  ({diam- 2 dx_{ends}})^2 (T_{water} - T_{surf}) }
{2dx_{ends}} 
$$
or with some simplification,

$$
Q_{surf} = 2 \pi k (T_{water} - T_{surf}) (
           \frac{ (height- 2 dx_{ends} )}
                {ln(\frac{diam}{(diam-(2dx_{side}))})} 
+ 
\frac{ ({diam- 2 dx_{ends}})^2 }
    {4dx_{ends}} 
)
$$

So the total conductive heat loss to the surface is

```{r}
Qsurf = 2 * pi * k * (Twater - Tsurf) * 
  (
    (height - 2 * dx_ends) / log(diam/(diam-2*dx_side))
                               +
    ( (diam - 2 * dx_ends)^2 ) / ( 4*dx_ends) 
  )

```

So with the assumed surface temperature, the total conductive heat loss through the insulation is `r round(Qsurf,1)` (W) or `r round(Qsurf*(24/1000),3)` (kWh/day)

Which as a check should be the sum of the Qside and Qends or `r round(Qside + Qends,1)` or `r round((Qside + Qends)*24/1000,3)` (kWh/day)

# Heat Loss from Surface to Ambient #

The heat losses from the surface of the water heater will a combination of convective, radiative and for the base further conduction. 

Losses from the side surfaces are modeled as convective to the ambient air and radiative to the surfaces of the test chamber. The convective losses will be modeled as a combination of free and forced convection from a heated vertical surface...

Losses from the top are modeled as free convection upward from a heated disk and also radiative.

Loss from the bottom is modeled as conductive through a wooden platform and then radiative to the test chamber surfaces and downward convection through the air below the platform.


Convective heat transfer is often calculated by determining a Nusselt number (Nu) for the conditions being investigated. Nu is the ratio of convective to conductive heat transfer at a boundary with a fluid. The conductive component is measured under the same conditions but for a hypothetically motionless fluid. So Nu = hLc/k, where Lc is a characteristic length. Solving for h, the convective heat transfer coefficient, then allows the heat loss to be calculated. 

Nusselt numbers are usually obtained from correlations of experimental data. The correlations to determined Nu are written in terms of Prandtl numbers and Rayleigh numbers. In the case of force convection the Reynolds number is used instead of the Rayleigh number.

The Rayleigh number (Ra) for a fluid is a dimensionless number associated with buoyancy-driven flow, also known as free or natural convection. It characterises the fluid's flow regime: a value in a lower range denotes laminar flow; a value in a higher range, turbulent flow. Below a critical value, there is no fluid motion and heat transfer is by conduction rather than convection. The Rayleigh number is defined as the product of the Grashof number and the Prandtl number.

The Grashof number (Gr) is a dimensionless number in fluid dynamics and heat transfer which approximates the ratio of the buoyancy to viscous force acting on a fluid. It frequently arises in the study of situations involving natural convection and is analogous to the Reynolds number.

The Prandtl number (Pr) is a dimensionless number defined as the ratio of momentum diffusivity to thermal diffusivity.

#### Grashof Number #

The Grashof number is calculated as 

$$Gr_ = \frac{g \beta (T_s-T_{\infty}) L^3}{\nu^2}$$

where;
```{r}
g     = 9.81     # acceleration due to Earth's gravity (m/s^2)
beta  = 3.43e-3  # the coefficient of thermal expansion of air at 20°C (1/K)
Ts    = 25       # the surface temperature (°C ), using initial estimate here
Tamb  = 20       # the bulk temperature (°C)
L     = height   # the vertical length (m), 
nu    = 15.28e-6 # the kinematic viscosity (m2/s), using air at 22.5°C

```
```{r}
# this is a function to calculate the Grashof number
# defaults to the previous values are provided
# explicitly define if using different values
Gr <- function(
g     = 9.81,     # acceleration due to Earth's gravity (m/s^2)
beta  = 3.43e-3,  # the coefficient of thermal expansion of air at 20°C (1/K)
Ts    = 25,       # the surface temperature (°C ), using initial estimate here
Tamb  = 20,       # the bulk temperature (°C)
L     = 1.295,    # the vertical length (m), 
nu    = 15.28e-6 # the kinematic viscosity (m2/s), using air at 22.5°C
) 
{
  Gr = g * beta * (Ts - Tamb) * L ^ 3 / nu^3
  return(Gr)
}


```
With these values the Grashof number is `r sprintf("%7.4e ", Gr())`

#### Prandtl number #

The Prandtl number is calculated as 

$$Gr_ = \frac{\nu}{\alpha}$$

where;
```{r}
nu    = 15.28e-6  # the kinematic viscosity (m2/s), for air air at 22.5°C
alpha = 22.045e-6 # the thermal diffusivity (m2/s) for air at 22.5°C)

```

```{r}
# this is a function to calculate the Prandtl number
# defaults to the previous values are provided
# explicitly define if using different values
Pr <- function(
nu    = 15.28e-6,  # the kinematic viscosity (m2/s), using air at 22.5°C
alpha = 22.045e-6 # the thermal diffusivity (m2/s) for air at 22.5°C)
) 
{
  Pr =  nu / alpha
  return(Pr)
}
```

With these values the Prandtl number is `r sprintf("%7.4f ", Pr())`




## Heat Loss from Side Surface to Ambient #






# References
